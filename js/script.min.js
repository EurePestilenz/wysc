$(document).ready(function(){$(".scrollify-action").on("click",function(){"next"==$(this).data("scroll")?$.scrollify.next():"prev"==$(this).data("scroll")&&$.scrollify.previous()}),$("body").scrollspy({target:".floating-scrollspy"}),$(".floating-scrollspy  a").on("click",function(event){event.preventDefault(),$("html, body").animate({scrollTop:$($.attr(this,"href")).offset().top},500)})});var PI2=2*Math.PI,HALF_PI=Math.PI/2,isTouch="ontouchstart"in window,isSafari=!!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/);function Canvas(options){options=_.clone(options||{}),this.options=_.defaults(options,this.options),this.el=this.options.el,this.ctx=this.el.getContext("2d"),this.dpr=window.devicePixelRatio||1,this.updateDimensions(),window.addEventListener("resize",this.updateDimensions.bind(this),!1),this.resetTarget(),isTouch?(this.el.addEventListener("touchstart",this.touchMove.bind(this),!1),this.el.addEventListener("touchmove",this.touchMove.bind(this),!1)):(window.addEventListener("mousemove",this.mouseMove.bind(this),!1),window.addEventListener("mouseout",this.resetTarget.bind(this),!1)),this.setupParticles(),this.loop()}function Particle(options){if(options=_.clone(options||{}),this.options=_.defaults(options,this.options),this.position=this.shift=new Vector(this.options.x,this.options.y),this.speed=this.options.speed||.01+.04*Math.random(),this.angle=this.options.angle||0,this.options.color){for(var color=this.options.color.split(","),colorIndex=-1;++colorIndex<3;)color[colorIndex]=Math.round(parseInt(color[colorIndex],10)+100*Math.random()-50),color[colorIndex]=Math.min(color[colorIndex],255),color[colorIndex]=Math.max(color[colorIndex],0);this.color=color.join(", ")}this.options.size=this.options.size||7,this.size=1+Math.random()*this.options.size,this.targetSize=this.options.targetSize||this.options.size,this.orbit=.5*this.options.radius+.5*this.options.radius*Math.random()}function Vector(x,y){this.x=x||0,this.y=y||0}Canvas.prototype.updateDimensions=function(){this.width=this.el.width=_.result(this.options,"width")*this.dpr,this.height=this.el.height=_.result(this.options,"height")*this.dpr,this.el.style.width=_.result(this.options,"width")+"px",this.el.style.height=_.result(this.options,"height")+"px"},Canvas.prototype.mouseMove=function(event){this.target=new Vector(event.clientX*this.dpr,event.clientY*this.dpr)},Canvas.prototype.resetTarget=function(){this.target=new Vector(this.width/2,this.height/2)},Canvas.prototype.touchMove=function(event){1===event.touches.length&&event.preventDefault(),this.target=new Vector(event.touches[0].pageX*this.dpr,event.touches[0].pageY*this.dpr)},Canvas.prototype.options={count:20,speed:.5,width:400,height:400,size:10,radius:5,background:"29, 22, 52",maxDistance:100},Canvas.prototype.setupParticles=function(){this.particles=[];for(var index=-1,between=PI2/this.options.count;++index<this.options.count;){var x,y,angle,max=Math.max(this.width,this.height);angle=(index+1)*between,x=Math.cos(angle)*max,x+=this.width/2,y=Math.sin(angle)*max;var particle=new Particle({x:x,y:y+=this.height/2,radius:this.options.radius,size:this.options.size,angle:angle,color:this.options.color});this.particles.push(particle)}},Canvas.prototype.findClosest=function(){for(var index=-1,pointsLength=this.particles.length;++index<pointsLength;){var closestIndex=-1;for(this.particles[index].closest=[];++closestIndex<pointsLength;){var closest=this.particles[closestIndex],distance=this.particles[index].position.distanceTo(closest.position);if(distance<this.options.maxDistance){var vector=new Vector(closest.position.x,closest.position.y);vector.opacity=1-distance/this.options.maxDistance,vector.distance=distance,this.particles[index].closest.push(vector)}}}},Canvas.prototype.loop=function(){isTouch||isSafari?this.ghost():this.ghostGradient(),this.options.maxDistance>0&&this.findClosest(),this.draw(),window.requestAnimationFrame(_.bind(this.loop,this))},Canvas.prototype.clear=function(){this.ctx.clearRect(0,0,this.width,this.height)},Canvas.prototype.ghost=function(){this.ctx.globalCompositeOperation="source-over",this.ctx.rect(0,0,this.width,this.height),"string"==typeof this.options.background?this.ctx.fillStyle="rgb("+this.options.background+")":this.ctx.fillStyle="rgb("+this.options.background[0]+")",this.ctx.fill()},Canvas.prototype.ghostGradient=function(){var gradient;if("string"==typeof this.options.background)this.ctx.fillStyle="rgb("+this.options.background+")";else{for(var gradient=this.ctx.createRadialGradient(this.width/2,this.height/2,0,this.width/2,this.height/2,Math.max(this.width,this.height)/2),length=this.options.background.length,i=0;i<length;i++)gradient.addColorStop((i+1)/length,"rgb("+this.options.background[i]+")");this.ctx.fillStyle=gradient}this.ctx.globalOpacity=.1,this.ctx.globalCompositeOperation="darken",this.ctx.fillRect(0,0,this.width,this.height)},Canvas.prototype.draw=function(){for(var index=-1,length=this.particles.length;++index<length;){var point=this.particles[index],color=point.color||this.options.color;point.update(this.target,index),this.ctx.globalAlpha=.3,this.ctx.globalCompositeOperation="lighten",this.ctx.fillStyle="rgb("+color+")",this.ctx.beginPath(),this.ctx.arc(point.position.x,point.position.y,point.size,0,PI2,!1),this.ctx.closePath(),this.ctx.fill(),this.options.maxDistance>0&&this.drawLines(point,color)}},Canvas.prototype.drawLines=function(point,color){color=color||this.options.color;var index=-1,length=point.closest.length;for(this.ctx.globalAlpha=.2,this.ctx.globalCompositeOperation="screen",this.ctx.lineCap="round";++index<length;)this.ctx.lineWidth=2*point.size*point.closest[index].opacity,this.ctx.strokeStyle="rgba("+color+", "+point.closest[index].opacity+")",this.ctx.beginPath(),this.ctx.moveTo(point.position.x,point.position.y),this.ctx.lineTo(point.closest[index].x,point.closest[index].y),this.ctx.stroke()},Particle.prototype.update=function(target,index){this.angle+=this.speed,this.shift.x+=(target.x-this.shift.x)*this.speed,this.shift.y+=(target.y-this.shift.y)*this.speed,this.position.x=this.shift.x+Math.cos(index+this.angle)*this.orbit,this.position.y=this.shift.y+Math.sin(index+this.angle)*this.orbit,isSafari||(this.size+=.03*(this.targetSize-this.size),Math.round(this.size)===Math.round(this.targetSize)&&(this.targetSize=1+Math.random()*this.options.size))},Vector.prototype.distanceTo=function(vector,abs){var distance=Math.sqrt(Math.pow(this.x-vector.x,2)+Math.pow(this.y-vector.y,2));return abs?Math.abs(distance):distance},new Canvas({el:document.getElementById("canvas"),count:25,speed:.3,radius:6,width:function(){return window.innerWidth},height:function(){return window.innerHeight},size:15,color:"30, 180, 1",maxDistance:100,background:["1, 62, 66","1, 40, 60"]});